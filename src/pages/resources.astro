---
import MyFooter from '../components/MyFooter.astro';
import { STRAPI_URL } from 'astro:env/server';

const cookie = Astro.cookies.get('site_lang');
const lang = cookie?.value; //|| 'en';

const strapiLocale = lang === 'ar' ? 'ar-EG' : 'en';
const sPath = `${STRAPI_URL}/api/resources?locale=${strapiLocale}&populate=*`;

async function getResourcesData(){
  const response = await fetch(sPath);
  const data = await response.json();
  return data.data[0];
}

const ResourcesData = await getResourcesData();
---
<!DOCTYPE html>
<html lang="en" class="page-resources">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedSure - Medical Insurance Services</title>
    <meta name="description" content="Comprehensive medical insurance solutions designed to protect you and your family. Experience peace of mind with MedSure's trusted healthcare coverage.">
    <link rel="stylesheet" href="/fonts/cairo/stylesheet.css">
	<link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/contact.css">
    <link rel="stylesheet" href="/css/services.css">
    <link rel="stylesheet" href="/css/counter.css">
    <link rel="stylesheet" href="/css/resources.css">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
</head>
<body>
 <!-- Header -->
    <header class="header" id="headermain">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <img src="/images/logo_icon.png" alt="MedSure Logo" class="logo-img">
                    </div>
                </div>

                <nav class="nav-desktop">
                    <a href="/" data-i18n="nav.home">Home</a> | 
                    <a href="/services" data-i18n="nav.services">Services</a>  | 
                    <a href="/beneficiaries" data-i18n="nav.beneficiaries">Beneficiaries</a>  | 
                    <a href="/medical-network" data-i18n="nav.medical_network">Medical network</a>  | 
                    <a href="/about" data-i18n="nav.about">About Us</a>  | 
                    <a href="/contact" data-i18n="nav.contact">Contact us</a>
                </nav>

                <div class="header-buttons">
					<a href="/medical-network" data-i18n="nav.find_provider" class="btn btn-medical">Find a Provider</a>
                </div>

                <div class="lang-selector">
                    <button class="lang-button" type="button" aria-haspopup="true" aria-expanded="false" onclick="toggleLangMenu(event)">
                        <span class="current-lang-label">EN</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="m6 9 6 6 6-6"/>
                        </svg>
                    </button>
                    <div class="lang-menu hidden" role="menu">
                        <button class="lang-option" role="menuitemradio" aria-checked="true" data-lang="en" onclick="setLanguage('en')">
                            <span class="check">âœ“</span>
                            <span>English</span>
                        </button>
                        <button class="lang-option" role="menuitemradio" aria-checked="false" data-lang="ar" onclick="setLanguage('ar')">
                            <span class="check">âœ“</span>
                            <span>Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
                        </button>
                    </div>
                </div>

                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <svg class="menu-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="4" x2="20" y1="6" y2="6"/>
                        <line x1="4" x2="20" y1="12" y2="12"/>
                        <line x1="4" x2="20" y1="18" y2="18"/>
                    </svg>
                    <svg class="close-icon hidden" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="m18 6-12 12"/>
                        <path d="m6 6 12 12"/>
                    </svg>
                </button>
            </div>

            <div class="mobile-menu hidden">
                <nav class="mobile-nav">
				    <a href="/" data-i18n="nav.home">Home</a>
                    <a href="/services" data-i18n="nav.services">Services</a>
                    <a href="/beneficiaries" data-i18n="nav.beneficiaries">Beneficiaries</a> 
                    <a href="/medical-network" data-i18n="nav.medical_network">Medical network</a> 
                    <a href="/about" data-i18n="nav.about">About Us</a> 
                    <a href="/contact" data-i18n="nav.contact">Contact us</a>

                    <div class="mobile-buttons">
						<a href="/medical-network" data-i18n="nav.find_provider" class="btn btn-medical">Find a Provider</a>
                    </div>
                </nav>
            </div>
        </div>
    </header>


    <main class="main-content">
        <!-- Hero Section -->
        <section class="resources-hero">
            <div class="container">
                <h1>{ResourcesData.PageTitle}</h1>
                <p>{ResourcesData.PageDescription}</p>
            </div>
        </section>

        <!-- Resources Grid -->
        <section class="resources-section">
            <div class="resources-container">
                <div class="section-header">
                    <h2>{ResourcesData.Title1}</h2>
                    <p>{ResourcesData.Description1}</p>
                </div>
                
                <div class="resources-grid">
                    <div class="resource-card">
                        <div class="resource-icon">ðŸ“Ž</div>
                        <h3>{ResourcesData.CorporateProfile.Title}</h3>
                        <p>{ResourcesData.CorporateProfile.Body}</p>
                        <a href={ResourcesData.CorporateProfile.BtnLink} target="_blank" class="download-btn">
                            <i class="fas fa-download"></i> {ResourcesData.CorporateProfile.BtnName}
                        </a>
                    </div>
                    
                    <div class="resource-card">
                        <div class="resource-icon">ðŸ“Ž</div>
                        <h3>{ResourcesData.NetworkList.Title}</h3>
                        <p>{ResourcesData.NetworkList.Body}</p>
                        <div class="download-links">
							<a href={ResourcesData.NetworkList.BtnLink} class="download-btn">
								<i class="fas fa-download"></i> {ResourcesData.NetworkList.BtnName}
							</a>
							<a href={ResourcesData.NetworkList.BtnLink2} class="download-btn">
								<i class="fas fa-download"></i> {ResourcesData.NetworkList.BtnName2}
							</a>
							<a href={ResourcesData.NetworkList.BtnLink3} class="download-btn">
								<i class="fas fa-download"></i> {ResourcesData.NetworkList.BtnName3}
							</a>
						</div>
                    </div>
                    
                    <div class="resource-card">
                        <div class="resource-icon">ðŸ“Ž</div>
                        <h3>{ResourcesData.SatisfactionSurvey.Title}</h3>
                        <p>{ResourcesData.SatisfactionSurvey.Body}</p>
                        <a href={ResourcesData.SatisfactionSurvey.BtnLink} class="download-btn">
                            <i class="fas fa-download"></i> {ResourcesData.SatisfactionSurvey.BtnName}
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Video Section -->
        <section class="video-section">
            <div class="video-container">
                <div class="section-header">
                    <h2>{ResourcesData.Title2}</h2>
                    <p>{ResourcesData.Description2}</p>
                </div>
                <div class="video-wrapper">
                    <iframe src={ResourcesData.YoutubeVideoLink} frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </section>
    </main>

    <!-- App Download Section -->
    <section class="app-download-section">
        <div class="container app-download-container">
            <div class="app-download-content">
                <h2>Get the MedSure App</h2>
                <p>Manage your benefits, approvals, claims, and find providers on the go.</p>
                <div class="store-buttons">
                    <a class="store-btn google" href={ResourcesData.GooglePlayLink} target="_blank" rel="noopener" aria-label="Get it on Google Play">
                        <i class="fab fa-google-play"></i>
                        <span>
                            <small>GET IT ON</small>
                            Google Play
                        </span>
                    </a>
                    <a class="store-btn apple" href={ResourcesData.AppStoreLink} target="_blank" rel="noopener" aria-label="Download on the App Store">
                        <i class="fab fa-apple"></i>
                        <span>
                            <small>Download on the</small>
                            App Store
                        </span>
                    </a>
                </div>
            </div>
            <div class="app-visual">
                <div class="phone-mockup">
				    <img src="/images/MobileApp.jpg" alt="MedSure Mobile App" class="MobileApp-image">
				</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <MyFooter />
    <script is:inline src="/js/translations.js"></script>
	<script is:inline src="/js/main.js"></script>
	<script is:inline src="/js/counter.js"></script>
</body>
</html>
